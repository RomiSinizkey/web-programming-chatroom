<%
// register.ejs
// WebStorm/EJS: define defaults so IDE won't complain (runtime still uses res.render vars)

// @ts-ignore
var step = typeof step !== 'undefined' ? step : 1;
// @ts-ignore
var data = typeof data !== 'undefined' ? data : {};
// @ts-ignore
var error = typeof error !== 'undefined' ? error : null;
%>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Register</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
</head>

<body class="bg-light">
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-12 col-sm-10 col-md-8 col-lg-6">
            <div class="card shadow-sm">
                <div class="card-body p-4">

                    <% if (step === 1) { %>
                        <h1 class="h4 text-center mb-3">Register Step 1</h1>

                        <% if (error) { %>
                            <div class="alert alert-danger" role="alert"><%= error %></div>
                        <% } %>

                        <form method="post" action="/register" novalidate>
                            <div class="mb-3">
                                <label class="form-label" for="email">Email</label>
                                <input
                                        id="email"
                                        type="email"
                                        name="email"
                                        class="form-control"
                                        required
                                        maxlength="32"
                                        value="<%= data.email || '' %>"
                                />
                            </div>

                            <div class="mb-3">
                                <label class="form-label" for="firstName">First name</label>
                                <input
                                        id="firstName"
                                        type="text"
                                        name="firstName"
                                        class="form-control"
                                        required
                                        minlength="3"
                                        maxlength="32"
                                        pattern="[A-Za-z]{3,32}"
                                        value="<%= data.firstName || '' %>"
                                />
                                <div class="form-text">Letters only (A-Z), 3-32 chars</div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label" for="lastName">Last name</label>
                                <input
                                        id="lastName"
                                        type="text"
                                        name="lastName"
                                        class="form-control"
                                        required
                                        minlength="3"
                                        maxlength="32"
                                        pattern="[A-Za-z]{3,32}"
                                        value="<%= data.lastName || '' %>"
                                />
                                <div class="form-text">Letters only (A-Z), 3-32 chars</div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Next</button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="/" class="link-secondary">Back to login</a>
                        </div>
                    <% } %>

                    <% if (step === 2) { %>
                        <h1 class="h4 text-center mb-3">Register Step 2</h1>

                        <div class="alert alert-secondary" role="alert">
                            <div><strong>Email:</strong> <%= data.email %></div>
                            <div><strong>Name:</strong> <%= data.firstName %> <%= data.lastName %></div>
                        </div>

                        <% if (error) { %>
                            <div class="alert alert-danger" role="alert"><%= error %></div>
                        <% } %>

                        <form method="post" action="/register/password" novalidate>
                            <div class="mb-3">
                                <label class="form-label" for="password">Password</label>
                                <input
                                        id="password"
                                        type="password"
                                        name="password"
                                        class="form-control"
                                        required
                                        minlength="3"
                                        maxlength="32"
                                />
                            </div>

                            <div class="mb-3">
                                <label class="form-label" for="password2">Repeat Password</label>
                                <input
                                        id="password2"
                                        type="password"
                                        name="password2"
                                        class="form-control"
                                        required
                                        minlength="3"
                                        maxlength="32"
                                />
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Submit</button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="/register" class="link-secondary">Back</a>
                        </div>
                    <% } %>

                </div>
            </div>

            <p class="text-center text-muted small mt-3 mb-0">
                Cookie timeout: 30 seconds from entering Step 2
            </p>
        </div>
    </div>
</div>
</body>
</html>
